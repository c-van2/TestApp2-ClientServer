@page "/teamcpd"
@using TestApp2.Shared
@inject HttpClient Http
@using MudBlazor

<PageTitle>Team CPD</PageTitle>
<MudContainer>
    <!-- 標題 -->
    <MudText Typo="Typo.h4" Class="mb-2">Team CPD</MudText>
    <MudText Typo="Typo.body1" Class="mb-4">This component demonstrates fetching data from the server.</MudText>

    @if (iaCpdRecords == null || mpfaCpdRecords == null)
    {
        <MudProgressLinear Indeterminate Color="Color.Primary" />
    }
    else
    {
        <!-- IA CPD Records -->
        <MudText Typo="Typo.h5" Class="mt-4">IA CPD Records</MudText>
        <MudTable Items="@iaCpdRecords" Hover="true" Dense="true" Breakpoint="Breakpoint.None">
            <HeaderContent>
                <MudTh>Name</MudTh>
                <MudTh>Full Name</MudTh>
                <MudTh>Total Hours</MudTh>
                <MudTh>Compulsory</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Name">@context.Name</MudTd>
                <MudTd DataLabel="Full Name">@context.FullName</MudTd>
                <MudTd DataLabel="Total Hours">@context.TotalHours</MudTd>
                <MudTd DataLabel="Compulsory">@context.Compulsory</MudTd>
            </RowTemplate>
        </MudTable>

        <!-- MPFA CPD Records -->
        <MudText Typo="Typo.h5" Class="mt-4">MPFA CPD Records</MudText>
        <MudTable Items="@mpfaCpdRecords" Hover="true" Dense="true" Breakpoint="Breakpoint.None">
            <HeaderContent>
                <MudTh>Name</MudTh>
                <MudTh>Full Name</MudTh>
                <MudTh>Total Hours (including Core)</MudTh>
                <MudTh>Core</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Name">@context.Name</MudTd>
                <MudTd DataLabel="Full Name">@context.FullName</MudTd>
                <MudTd DataLabel="Total Hours">@context.TotalHours.ToString("0.0")</MudTd>
                <MudTd DataLabel="Core">@context.Core.ToString("0.0")</MudTd>
            </RowTemplate>
        </MudTable>
    }
</MudContainer>



@code {
    private bool _loading = false;
    private IaCpdRecord[]? iaCpdRecords;
    private MpfaCpdRecord[]? mpfaCpdRecords;

    protected override async Task OnInitializedAsync()
    {
        iaCpdRecords = await Http.GetFromJsonAsync<IaCpdRecord[]>("TeamCPD/IAcpd");
        mpfaCpdRecords = await Http.GetFromJsonAsync<MpfaCpdRecord[]>("TeamCPD/MPFAcpd");
    }
}